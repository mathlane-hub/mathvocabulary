<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Math Vocabulary Matching Activity</title>
  <style>
    :root{font-family:system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial;font-size:16px}
    body{max-width:980px;margin:24px auto;padding:16px}
    h1{font-size:1.4rem;margin-bottom:0.2rem}
    p.lead{margin-top:0;color:#333}
    .controls{display:flex;gap:8px;flex-wrap:wrap;margin:12px 0}
    button{padding:8px 12px;border-radius:6px;border:1px solid #888;background:#fff;cursor:pointer}
    button.primary{background:#2563eb;color:#fff;border-color:#1e40af}
    .board{display:flex;gap:24px;margin-top:12px}
    .col{flex:1;min-width:260px}
    .list{border:1px dashed #ccc;border-radius:8px;padding:12px;min-height:120px;background:#fafafa}
    .item{padding:8px 10px;margin:6px 0;border-radius:6px;background:#fff;border:1px solid #ddd;cursor:grab}
    .placeholder{padding:8px;margin:6px 0;border-radius:6px;background:linear-gradient(90deg,#f3f4f6,#fff);border:1px dashed #e2e8f0;color:#888}
    .match.correct{background:#dcfce7;border-color:#bbf7d0}
    .match.incorrect{background:#fee2e2;border-color:#fecaca}
    .feedback{margin-top:12px}
    .hidden{display:none}
    footer{margin-top:24px;color:#666;font-size:0.9rem}
    @media (max-width:700px){.board{flex-direction:column}}
  </style>
</head>
<body>
  <h1>Math Vocabulary: Match the Word to its Definition</h1>
  <p class="lead">Drag the words on the left and drop them on the matching definitions on the right. When finished click "Check Answers".</p>

  <div class="controls">
    <button id="shuffleBtn">Shuffle</button>
    <button id="checkBtn" class="primary">Check Answers</button>
    <button id="showBtn">Show Answers</button>
    <button id="resetBtn">Reset</button>
    <button id="exportBtn">Export Results (CSV)</button>
  </div>

  <div class="board" aria-live="polite">
    <div class="col">
      <h3>Words</h3>
      <div id="wordsList" class="list" aria-label="Draggable words" role="list"></div>
    </div>
    <div class="col">
      <h3>Definitions</h3>
      <div id="defsList" class="list" aria-label="Drop definitions" role="list"></div>
    </div>
  </div>

  <div class="feedback" id="feedback" aria-live="polite"></div>

  <footer>
    Tip: To customize the activity edit the `data` array in the JavaScript at the top of the HTML file. Keep the structure {id, word, definition}.
  </footer>

  <script>
    // -- Customize the word list here --
    // Format: { id: 'unique', word: 'Term', definition: 'Short definition' }
    const data = [
      { id: 'w1', word: 'integer', definition: 'A whole number; can be positive, negative, or zero.' },
      { id: 'w2', word: 'fraction', definition: 'A number representing part of a whole; written as numerator/denominator.' },
      { id: 'w3', word: 'radius', definition: 'A line segment from the center of a circle to its edge.' },
      { id: 'w4', word: 'diameter', definition: 'A line segment passing through the center connecting two points on a circle; twice the radius.' },
      { id: 'w5', word: 'parallel', definition: 'Two lines in a plane that never meet and are always the same distance apart.' },
      { id: 'w6', word: 'perimeter', definition: 'The total length around a 2D shape.' },
      { id: 'w7', word: 'area', definition: 'The amount of space inside a 2D shape; measured in square units.' },
      { id: 'w8', word: 'equation', definition: 'A mathematical statement that shows two expressions are equal using an = sign.' },
      { id: 'w9', word: 'variable', definition: 'A symbol (often a letter) that represents an unknown or changeable value.' },
      { id: 'w10', word: 'factor', definition: 'A number or expression that divides another number or expression evenly.' }
    ];

    // -- End customization area --

    const wordsList = document.getElementById('wordsList');
    const defsList = document.getElementById('defsList');
    const shuffleBtn = document.getElementById('shuffleBtn');
    const checkBtn = document.getElementById('checkBtn');
    const showBtn = document.getElementById('showBtn');
    const resetBtn = document.getElementById('resetBtn');
    const exportBtn = document.getElementById('exportBtn');
    const feedback = document.getElementById('feedback');

    let shuffledWords = [];
    let shuffledDefs = [];
    let assignments = {}; // defId -> wordId

    function shuffle(array){
      // Fisher-Yates
      const a = array.slice();
      for(let i=a.length-1;i>0;i--){
        const j = Math.floor(Math.random()*(i+1));
        [a[i],a[j]]=[a[j],a[i]];
      }
      return a;
    }

    function render(){
      wordsList.innerHTML = '';
      defsList.innerHTML = '';
      assignments = {};

      shuffledWords = shuffle(data);
      shuffledDefs = shuffle(data);

      shuffledWords.forEach(item => {
        const el = document.createElement('div');
        el.className = 'item';
        el.draggable = true;
        el.id = 'word-' + item.id;
        el.setAttribute('role','listitem');
        el.setAttribute('aria-grabbed','false');
        el.textContent = item.word;

        el.addEventListener('dragstart', e => {
          e.dataTransfer.setData('text/plain', item.id);
          requestAnimationFrame(()=>el.style.opacity = '0.5');
        });
        el.addEventListener('dragend', e => { el.style.opacity=''; el.setAttribute('aria-grabbed','false'); });
        wordsList.appendChild(el);
      });

      shuffledDefs.forEach(item => {
        const slot = document.createElement('div');
        slot.className = 'placeholder';
        slot.id = 'def-' + item.id;
        slot.setAttribute('role','listitem');
        slot.setAttribute('aria-dropeffect','none');
        slot.setAttribute('data-correct', item.id);
        slot.innerHTML = `<strong>Definition:</strong> <span class="def-text">${item.definition}</span>`;

        slot.addEventListener('dragover', e => { e.preventDefault(); slot.classList.add('hover'); });
        slot.addEventListener('dragleave', e => { slot.classList.remove('hover'); });
        slot.addEventListener('drop', e => {
          e.preventDefault();
          slot.classList.remove('hover');
          const wordId = e.dataTransfer.getData('text/plain');
          placeWordInSlot(wordId, slot.id);
        });

        defsList.appendChild(slot);
      });

      feedback.textContent = '';
    }

    function placeWordInSlot(wordId, slotId){
      // remove word element from wordsList and append inside slot; if slot already has a word, return it
      const slot = document.getElementById(slotId);
      const existing = slot.querySelector('.item');
      if(existing){
        // return existing to words list
        wordsList.appendChild(existing);
      }

      const wordEl = document.getElementById('word-' + wordId);
      if(!wordEl) return;
      slot.appendChild(wordEl);
      wordEl.style.cursor = 'default';
      wordEl.draggable = false;
      assignments[slotId] = wordId;
    }

    function checkAnswers(){
      let correct = 0;
      const total = data.length;
      shuffledDefs.forEach(d =>{
        const slotId = 'def-' + d.id;
        const slot = document.getElementById(slotId);
        const assignedWordId = assignments[slotId];
        // clear classes
        slot.classList.remove('match','correct','incorrect');
        if(assignedWordId){
          if(assignedWordId === d.id){
            slot.classList.add('match','correct');
            correct++;
          } else {
            slot.classList.add('match','incorrect');
          }
        } else {
          // no answer
          slot.classList.add('match','incorrect');
        }
      });
      feedback.textContent = `You matched ${correct} out of ${total} correctly.`;
    }

    function showAnswers(){
      // return any placed words, then place correct words in correct slots
      // clear words list
      const placed = Object.values(assignments);
      // move all words back to wordsList
      data.forEach(d => {
        const el = document.getElementById('word-' + d.id);
        if(el){
          wordsList.appendChild(el);
          el.draggable = false;
          el.style.cursor='default';
        }
      });
      // place correct words
      data.forEach(d => {
        const slot = document.getElementById('def-' + d.id);
        const w = document.getElementById('word-' + d.id);
        if(slot && w){
          slot.appendChild(w);
          assignments[slot.id]=d.id;
          slot.classList.remove('incorrect');
          slot.classList.add('match','correct');
        }
      });
      feedback.textContent = 'Answers shown.';
    }

    function reset(){
      render();
      // make words draggable again
      data.forEach(d=>{
        const el = document.getElementById('word-' + d.id);
        if(el){ el.draggable = true; el.style.cursor='grab'; el.setAttribute('aria-grabbed','false'); }
      });
    }

    function exportCSV(){
      const rows = [['definition','assigned_word','correct_word','is_correct']];
      shuffledDefs.forEach(d=>{
        const slotId = 'def-' + d.id;
        const assigned = assignments[slotId] || '';
        const assignedWord = assigned ? (data.find(x=>x.id===assigned)||{}).word || '' : '';
        const correctWord = d.word;
        const isCorrect = assigned === d.id ? 'true' : 'false';
        rows.push([`"${d.definition.replace(/"/g,'""')}"`, `"${assignedWord.replace(/"/g,'""')}"`, `"${correctWord.replace(/"/g,'""')}"`, isCorrect]);
      });
      const csv = rows.map(r=>r.join(',')).join('\n');
      const blob = new Blob([csv], {type:'text/csv'});
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url; a.download = 'matching-results.csv';
      document.body.appendChild(a);
      a.click();
      a.remove();
      URL.revokeObjectURL(url);
    }

    shuffleBtn.addEventListener('click', ()=>{ render(); });
    checkBtn.addEventListener('click', ()=>{ checkAnswers(); });
    showBtn.addEventListener('click', ()=>{ showAnswers(); });
    resetBtn.addEventListener('click', ()=>{ reset(); });
    exportBtn.addEventListener('click', ()=>{ exportCSV(); });

    // initial render
    render();
  </script>
</body>
</html>